{"version":3,"sources":["pages/quotation/index.js","services/quotation/index.js"],"names":["Quotation","history","useHistory","useState","isLoading","setIsLoading","dispatch","useDispatch","isOpen","filter","setFilter","columns","title","dataIndex","width","render","_","values","Text","quotationDate","formatDDMMYYYY","BLANK_VALUE","minWidth","align","value","formatCurrency","Number","to","file","id","fileName","disabled","isAccessed","PER","BAO_GIA_SUA","handleDeleteQuotation","deleteQuotations","then","res","refresh","isSuccess","success","DELETE_SUCCESS","actions","error","message","catch","DELETE_ERROR","finally","BAO_GIA_XEM","onCreate","push","isFilter","onFilter","handleDelete","confirm","icon","content","okText","cancelText","onOk","confirmLoading","isShowActionAdd","BAO_GIA_THEM","isShowActionDelete","BAO_GIA_XOA","handleClosed","onApplyFilter","className","urlEndpoint","urlEndpointTableQuotation","summaryNumberCol","getQuotationById","api","createQuotation","payload","input","data","ids","getQuotationNumberToCreate","urlEndpointQuotation","reviewQuotation"],"mappings":"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","file":"static/js/39.733627f9.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport { Modal, message, Typography, Table } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { useDispatch } from 'react-redux';\r\nimport { NavLink, useHistory } from 'react-router-dom';\r\n// import { ButtonEdit } from 'common/components/Buttons';\r\nimport Grid from 'components/Grid';\r\nimport HeaderPage from 'pages/home/header-page';\r\nimport PageWrapper from 'components/Layout/PageWrapper';\r\nimport { BLANK_VALUE } from 'static/Constants';\r\nimport { DELETE_ERROR, DELETE_SUCCESS } from 'utils/common/messageContants';\r\nimport { urlEndpointTableQuotation, deleteQuotations } from 'services/quotation/';\r\nimport { formatDDMMYYYY } from 'utils/formatDate';\r\nimport * as actions from 'redux/global/actions';\r\nimport Filter from 'pages/home/components/filter/filterCommon';\r\nimport { API_ENDPOINT } from 'config/env';\r\nimport { ButtonEdit } from 'common/components/Buttons';\r\nimport { formatCurrency } from 'utils/format';\r\nimport { isAccessed } from 'utils/utils';\r\nimport { PER } from 'common/enum';\r\n\r\nconst Quotation = () => {\r\n  let history = useHistory();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const [filter, setFilter] = useState({\r\n    isOpen: false,\r\n  });\r\n\r\n  const readGrid = (refresh) => {\r\n    dispatch(actions.refreshGrid(refresh));\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Số báo giá',\r\n      dataIndex: 'number',\r\n      width: '60px',\r\n    },\r\n    {\r\n      title: 'Ngày báo giá',\r\n      dataIndex: 'quotationDate',\r\n      width: '150px',\r\n      render: (_, values) => (\r\n        <Typography.Text>{values?.quotationDate ? formatDDMMYYYY(values?.quotationDate) : BLANK_VALUE}</Typography.Text>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Người báo giá',\r\n      dataIndex: ['quotationInCharge', 'name'],\r\n      width: '250px',\r\n    },\r\n    {\r\n      title: 'Khách hàng',\r\n      dataIndex: ['customer', 'name'],\r\n      minWidth: '250px',\r\n    },\r\n    {\r\n      title: 'Tổng tiền (Chưa VAT)',\r\n      dataIndex: 'totalAmount',\r\n      align: 'right',\r\n      width: '200px',\r\n      render: (value) => `${value ? formatCurrency(Number(value)) : ''}`,\r\n    },\r\n    {\r\n      title: 'File báo giá',\r\n      dataIndex: ['file', 'fileName'],\r\n      render: (_, values) => (\r\n        <NavLink to={`/ tai - lieu / ${values?.file?.id}`}>{values?.file?.fileName ?? ''}</NavLink>\r\n      ),\r\n    },\r\n    // {\r\n    //   title: 'File cấu hình',\r\n    //   dataIndex: ['configurationFiles'],\r\n    //   render: (_, values) => renderListFile(values.configurationFiles),\r\n    // },\r\n    {\r\n      title: '',\r\n      dataIndex: 'action',\r\n      render: (_, values) => (\r\n        <NavLink to={`chinh-sua-bao-gia/${values.id}`}>\r\n          <ButtonEdit disabled={!isAccessed(PER.BAO_GIA_SUA)} />\r\n        </NavLink>\r\n      ),\r\n      width: 30,\r\n    },\r\n  ];\r\n\r\n  const renderListFile = (configurationFiles) => {\r\n    if (!configurationFiles) return;\r\n\r\n    return configurationFiles.map((x) => (\r\n      <div>\r\n        {' '}\r\n        <a href={`${API_ENDPOINT}${x.filePathUrl.slice(1)}`}>{x.fileName}</a>{' '}\r\n      </div>\r\n    ));\r\n  };\r\n\r\n  const handleDeleteQuotation = (values) => {\r\n    setIsLoading(true);\r\n    deleteQuotations(values)\r\n      .then((res) => {\r\n        if (res.isSuccess) {\r\n          message.success(DELETE_SUCCESS);\r\n          readGrid(true);\r\n        } else {\r\n          message.error(res.message);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        message.error(DELETE_ERROR);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(true);\r\n      });\r\n  };\r\n\r\n  const onCreateQuote = () => {\r\n    history.push('/tao-bao-gia');\r\n  };\r\n\r\n  const onClickDelete = (values) => {\r\n    Modal.confirm({\r\n      title: 'Xác Nhận',\r\n      icon: <ExclamationCircleOutlined />,\r\n      content: 'Bạn có chắc chắn muốn xóa dòng dữ liệu đã chọn?',\r\n      okText: 'Xác Nhận',\r\n      cancelText: 'Hủy',\r\n      onOk: () => handleDeleteQuotation(values),\r\n      confirmLoading: isLoading,\r\n    });\r\n  };\r\n\r\n  const renderFilter = () => (\r\n    <Filter\r\n      isOpen={filter.isOpen}\r\n      title={'Lọc hóa đơn'}\r\n      handleClosed={() => setFilter({ isOpen: false })}\r\n      onApplyFilter={(values) => {\r\n        dispatch(actions.filters(values));\r\n      }}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <>\r\n      {isAccessed(PER.BAO_GIA_XEM) && (\r\n        <div>\r\n          <HeaderPage\r\n            title=\"BÁO GIÁ\"\r\n            actions=\"default\"\r\n            onCreate={onCreateQuote}\r\n            isFilter\r\n            onFilter={() => setFilter({ isOpen: true })}\r\n            handleDelete={onClickDelete}\r\n            isShowActionAdd={isAccessed(PER.BAO_GIA_THEM)}\r\n            isShowActionDelete={isAccessed(PER.BAO_GIA_XOA)}\r\n          />\r\n          {renderFilter()}\r\n          <div className=\"main__application\">\r\n            <PageWrapper>\r\n              <Grid urlEndpoint={urlEndpointTableQuotation} columns={columns} summaryNumberCol={5} />\r\n            </PageWrapper>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Quotation;\r\n","/** @format */\r\n\r\nimport * as api from '../../config/axios';\r\nexport const urlEndpointQuotation = '/api/quotations/';\r\nexport const urlEndpointTableQuotation = '/api/quotations';\r\n\r\nexport const getQuotationById = (id) => api.sendGet(urlEndpointQuotation + id);\r\n\r\nexport const getQuotations = (data) => api.sendGet(urlEndpointQuotation, data);\r\n\r\nexport const createQuotation = (payload) =>\r\n  api.sendPost(urlEndpointQuotation, {\r\n    id: payload.id,\r\n    input: payload,\r\n  });\r\n\r\nexport const updateQuotation = (payload) => api.sendPost(urlEndpointQuotation, payload);\r\n\r\nexport const deleteQuotations = (payload) =>\r\n  api.sendDelete(urlEndpointQuotation, {\r\n    data: { ids: payload },\r\n  });\r\n\r\nexport const getQuotationNumberToCreate = () => api.sendGet(urlEndpointQuotation + 'quotationNumber', {});\r\n\r\nexport const reviewQuotation = (payload) =>\r\n  api.sendPost(urlEndpointQuotation + 'review', {\r\n    id: payload.id,\r\n    input: payload,\r\n  });\r\n"],"sourceRoot":""}