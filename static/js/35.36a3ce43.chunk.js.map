{"version":3,"sources":["pages/contract/index.js","services/contract/index.js"],"names":["Contract","history","useHistory","useState","isLoading","setIsLoading","dispatch","useDispatch","isOpen","filter","setFilter","columns","title","dataIndex","minWidth","render","_","values","Text","contractDate","formatDDMMYYYY","BLANK_VALUE","className","isWarning","contractDateComplete","width","align","value","formatCurrency","Number","to","id","disabled","isAccessed","PER","HOP_DONG_SUA","handleDeleteCustomer","deleteContracts","then","res","refresh","isSuccess","success","DELETE_SUCCESS","actions","error","DELETE_ERROR","catch","finally","HOP_DONG_XEM","onCreate","push","isFilter","onFilter","handleDelete","confirm","icon","content","okText","cancelText","onOk","confirmLoading","isShowActionAdd","HOP_DONG_THEM","isShowActionDelete","HOP_DONG_XOA","handleClosed","onApplyFilter","urlEndpoint","urlEndpointTableContract","summaryNumberCol","getContractById","api","createContract","payload","input","data","ids","reviewContract","urlEndpointContract"],"mappings":"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","file":"static/js/35.36a3ce43.chunk.js","sourcesContent":["import React, { useState } from 'react';\r\nimport { Modal, message, Typography, Table } from 'antd';\r\nimport { ExclamationCircleOutlined } from '@ant-design/icons';\r\nimport { useDispatch } from 'react-redux';\r\nimport { NavLink, useHistory } from 'react-router-dom';\r\n// import { ButtonEdit } from 'common/components/Buttons';\r\nimport Grid from 'components/Grid';\r\nimport HeaderPage from 'pages/home/header-page';\r\nimport PageWrapper from 'components/Layout/PageWrapper';\r\nimport { DELETE_ERROR, DELETE_SUCCESS } from 'utils/common/messageContants';\r\nimport { urlEndpointTableContract, deleteContracts } from 'services/contract';\r\nimport * as actions from 'redux/global/actions';\r\nimport { formatDDMMYYYY } from 'utils/formatDate';\r\nimport { BLANK_VALUE } from 'static/Constants';\r\nimport Filter from 'pages/home/components/filter/filterCommon';\r\nimport { formatCurrency } from 'utils/format';\r\nimport { ButtonEdit } from 'common/components/Buttons';\r\nimport './index.less';\r\nimport { isAccessed } from 'utils/utils';\r\nimport { PER } from 'common/enum';\r\n\r\nconst Contract = () => {\r\n  let history = useHistory();\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const dispatch = useDispatch();\r\n  const [filter, setFilter] = useState({\r\n    isOpen: false,\r\n  });\r\n\r\n  const readGrid = (refresh) => {\r\n    dispatch(actions.refreshGrid(refresh));\r\n  };\r\n\r\n  const columns = [\r\n    {\r\n      title: 'Số Hợp đồng',\r\n      dataIndex: 'number',\r\n    },\r\n    {\r\n      title: 'Ngày ký Hợp đồng',\r\n      dataIndex: 'contractDate',\r\n      minWidth: '150px',\r\n      render: (_, values) => (\r\n        <Typography.Text>{values?.contractDate ? formatDDMMYYYY(values?.contractDate) : BLANK_VALUE}</Typography.Text>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Ngày hoàn thành',\r\n      dataIndex: 'contractDateComplete',\r\n      minWidth: '150px',\r\n      render: (_, values) => (\r\n        <Typography.Text className={values.isWarning ? 'is-warning-text' : ''}>\r\n          {values?.contractDateComplete ? formatDDMMYYYY(values?.contractDateComplete) : BLANK_VALUE}\r\n        </Typography.Text>\r\n      ),\r\n    },\r\n    {\r\n      title: 'Người quản lý hợp đồng',\r\n      dataIndex: ['employeeManageContract', 'name'],\r\n      minWidth: '350px',\r\n    },\r\n    {\r\n      title: 'Khách hàng',\r\n      dataIndex: ['customer', 'name'],\r\n      minWidth: '350px',\r\n    },\r\n    {\r\n      title: 'Tổng tiền (Chưa VAT)',\r\n      dataIndex: 'total',\r\n      width: '200px',\r\n      align: 'right',\r\n      render: (value) => `${value ? formatCurrency(Number(value)) : ''}`,\r\n    },\r\n    // {\r\n    //   title: 'File hợp đồng',\r\n    //   dataIndex: ['contractFile', 'fileName'],\r\n    //   minWidth: '300px',\r\n    //   render: (_, values) => (\r\n    //     <NavLink to={`/tai-lieu/${values?.contractFile?.id}`}>{values?.contractFile?.fileName ?? ''}</NavLink>\r\n    //   ),\r\n    // },\r\n    {\r\n      title: '',\r\n      dataIndex: 'action',\r\n      render: (_, values) => (\r\n        <NavLink to={`chinh-sua-hop-dong/${values.id}`}>\r\n          <ButtonEdit disabled={!isAccessed(PER.HOP_DONG_SUA)} />\r\n        </NavLink>\r\n      ),\r\n      width: 30,\r\n    },\r\n  ];\r\n\r\n  const handleDeleteCustomer = (values) => {\r\n    setIsLoading(true);\r\n    deleteContracts(values)\r\n      .then((res) => {\r\n        if (res.isSuccess) {\r\n          message.success(DELETE_SUCCESS);\r\n          readGrid(true);\r\n        } else {\r\n          message.error(DELETE_ERROR);\r\n        }\r\n      })\r\n      .catch(() => {\r\n        message.error(DELETE_ERROR);\r\n      })\r\n      .finally(() => {\r\n        setIsLoading(true);\r\n      });\r\n  };\r\n\r\n  const onCreateContract = () => {\r\n    history.push('/tao-hop-dong');\r\n  };\r\n\r\n  const onClickDelete = (values) => {\r\n    Modal.confirm({\r\n      title: 'Xác Nhận',\r\n      icon: <ExclamationCircleOutlined />,\r\n      content: 'Bạn có chắc chắn muốn xóa dòng dữ liệu đã chọn?',\r\n      okText: 'Xác Nhận',\r\n      cancelText: 'Hủy',\r\n      onOk: () => handleDeleteCustomer(values),\r\n      confirmLoading: isLoading,\r\n    });\r\n  };\r\n\r\n  const renderFilter = () => (\r\n    <Filter\r\n      isOpen={filter.isOpen}\r\n      title={'Lọc hợp đồng'}\r\n      handleClosed={() => setFilter({ isOpen: false })}\r\n      onApplyFilter={(values) => {\r\n        dispatch(actions.filters(values));\r\n      }}\r\n    />\r\n  );\r\n\r\n  return (\r\n    <div id=\"contract-page\">\r\n      {isAccessed(PER.HOP_DONG_XEM) && (\r\n        <div>\r\n          <HeaderPage\r\n            title=\"HỢP ĐỒNG\"\r\n            actions=\"default\"\r\n            onCreate={onCreateContract}\r\n            isFilter\r\n            onFilter={() => setFilter({ isOpen: true })}\r\n            handleDelete={onClickDelete}\r\n            isShowActionAdd={isAccessed(PER.HOP_DONG_THEM)}\r\n            isShowActionDelete={isAccessed(PER.HOP_DONG_XOA)}\r\n          />\r\n          {renderFilter()}\r\n          <div className=\"main__application\">\r\n            <PageWrapper>\r\n              <Grid urlEndpoint={urlEndpointTableContract} columns={columns} summaryNumberCol={6} />\r\n            </PageWrapper>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Contract;\r\n","/** @format */\r\n\r\nimport * as api from '../../config/axios';\r\nexport const urlEndpointContract = '/api/contract/';\r\nexport const urlEndpointTableContract = '/api/contract';\r\n\r\nexport const getContractById = (id) => api.sendGet(urlEndpointContract + id);\r\n\r\nexport const getContracts = (data) => api.sendGet(urlEndpointContract, data);\r\n\r\nexport const createContract = (payload) =>\r\n  api.sendPost(urlEndpointContract, {\r\n    id: payload.id,\r\n    input: payload,\r\n  });\r\n\r\nexport const updateContract = (payload) => api.sendPost(urlEndpointContract, payload);\r\n\r\nexport const deleteContracts = (payload) =>\r\n  api.sendDelete(urlEndpointContract, {\r\n    data: { ids: payload },\r\n  });\r\n\r\nexport const getContractNumberToCreate = () => api.sendGet(urlEndpointContract + 'quotationNumber', {});\r\n\r\nexport const reviewContract = (payload) =>\r\n  api.sendPost(urlEndpointContract + 'review', {\r\n    id: payload.id,\r\n    input: payload,\r\n  });\r\n"],"sourceRoot":""}